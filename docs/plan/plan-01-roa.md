<!--
doc_id: plan-01
title: 実装計画: リソース指向設計
version: 1.0.0
status: stable
source_template: docs/templates/plan-template.md
-->

# 実装計画: リソース指向設計

## 1. ゴールとスコープ
1. **リリースゴール:**
   1) Java 21 / Spring Boot WebMVC のサンプル API を実装し、RESTful 設計の学習に必要な最小構成を提供する。
   2) RFC 9110/9112 に準拠した HTTP の扱いと、RFC 9457 の Problem Details を教材内で説明できる状態にする。
   3) 実装作業は単一のコーディングエージェントが担当し、人はレビューと承認に集中する。
2. **完了条件:**
   1) `openapi/openapi.yaml` にリソース設計と Problem Details のスキーマが反映されている。
   2) サンプル API が `application/problem+json` を返し、設計ドキュメントと整合している。
   3) テスト (ユニット/統合/契約) が実行でき、主要フローが確認されている。
   4) 教材本文に RFC 9110/9112/9457 の参照が明記されている。
   5) コーディングエージェントの成果物が人レビューで承認されている。

## 2. WBS / タスク分解
1. **Step 1: API 契約の整理 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) リソースと操作を OpenAPI 仕様に反映する。
   2) エラー応答に RFC 9457 の Problem Details を追加する。
   3) 依存関係: `docs/design/design-01-roa.md`
2. **Step 2: プロジェクト構成の整備 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) Maven のサブモジュールを追加し、実装をサブモジュール側に配置する。
   2) `pom.xml` への直接依存追加を避け、サブモジュール側で依存を管理する。
   3) 依存関係: `docs/design/design-01-roa.md`
3. **Step 3: サンプル API 実装 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) Controller / Service / Repository / ErrorHandler を実装する。
   2) Problem Details の生成と `application/problem+json` の返却を実装する。
   3) 依存関係: OpenAPI 仕様の更新完了 / プロジェクト構成の整備
4. **Step 4: HTTP セマンティクス確認 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) メソッドの安全性・冪等性に沿った API 振る舞いを確認する。
   2) ステータスコードの使い分けを RFC 9110 に沿って整理する。
   3) 依存関係: サンプル API 実装
5. **Step 5: テスト整備 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) ユニットテストで Service と ErrorHandler を検証する。
   2) 統合テストで HTTP 応答と Problem Details を検証する。
   3) 契約テストで OpenAPI と実装の整合を確認する。
   4) 依存関係: サンプル API 実装
6. **Step 6: 教材更新 (実装: 単一のコーディングエージェント / レビュー: 人):**
   1) RFC 9110/9112/9457 の参照を本文に明記する。
   2) 非 RESTful な例の説明を追加する。
   3) 依存関係: API 契約の整理

## 3. スケジュールとマイルストーン
1. **タイムライン:**
   1) フェーズ 1: API 契約整理 / プロジェクト構成の整備 / サンプル実装 / テスト準備
   2) フェーズ 2: テスト実施 / 教材更新 / リハーサル
2. **チェックポイント:**
   1) API 契約のレビュー (フェーズ 1 中 / 人レビュー)
   2) 単一コーディングエージェント成果物のレビュー (フェーズ 2 中 / 人レビュー)
   3) 最終デモのリハーサル (フェーズ 2 終了時)

## 4. リスク・問題管理
1. **リスク登録:**
   1) RFC の解釈違いによる説明のブレ (影響: 高 / 対策: ADR で根拠を明示する)。
   2) 学習範囲の拡張によるスコープ超過 (影響: 中 / 対策: 1 日完結を基準に削減する)。
   3) コーディングエージェントの成果物が要件と不整合になる (影響: 中 / 対策: 人レビューと検証ステップを必須化する)。
2. **問題管理:**
   1) JDK 21 の導入失敗はブロッカーとし、環境ガイドを作成して対応する。
   2) OpenAPI 仕様と実装差異は優先的に修正し、エスカレーションは意思決定者へ報告する。

## 5. 品質保証と検証
1. **テスト計画:**
   1) ユニット/統合/契約テストの実装と実行は単一のコーディングエージェントが担当し、結果レビューは人が行う。
   2) テスト環境はローカルのみとし、外部依存は排除する。
2. **検証ステップ:**
   - [ ] OpenAPI 仕様と API 実装の整合が取れている。
   - [ ] RFC 9457 の必須フィールドがエラー応答に含まれている。
   - [ ] RFC 9110 のステータスコード運用が説明できる。
   - [ ] 教材の記述が ADR と矛盾していない。
   - [ ] 人レビューで成果物が承認されている。

## 6. 変更管理とコミュニケーション
1. **変更フロー:**
   1) 変更要求の受領 → 影響範囲の評価 → ADR / 設計 / 要件の更新 → 単一コーディングエージェントへ実装依頼 → 人レビュー。
2. **コミュニケーション:**
   1) 進捗は `docs/plan/plan-01-roa.md` の更新履歴で管理する。
   2) 単一コーディングエージェントの作業要約を残し、人レビューの判断理由を記録する。
   3) 重要な決定は ADR に記録する。

## 7. 関連ドキュメント
1. `docs/analysis/analysis-01-roa.md`
2. `docs/requirements/requirements-01-roa.md`
3. `docs/design/design-01-roa.md`
4. `docs/adr/adr-01-rfc9457.md`
5. `docs/adr/adr-02-java21-spring-boot.md`
6. `docs/adr/adr-03-http-rfc9110-9112.md`
